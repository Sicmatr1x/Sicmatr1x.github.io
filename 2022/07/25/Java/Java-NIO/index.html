<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Java NIO | Sicmatr1x's Blog</title><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Sicmatr1x's Blog" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/toolkit/"><span class="navItemTitle">Toolkit</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>Java NIO</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2022-07-25T02:25:07.000Z" id="date"> 2022-07-25</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-03-25T16:00:00.000Z" id="updated"> 2023-03-26</time></div></span></div></div><hr><div id="post-content"><p>Java NIO(New IO或Non Bloking IO)是从Java1.4版本开始引入的一个新的IO API，NIO支持面向缓冲区的、基于通道的IO操作，读写文件更加高效。</p>
<h2 id="Java-NIO"><a href="#Java-NIO" class="headerlink" title="Java NIO"></a>Java NIO</h2><h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><ul>
<li>IO<ul>
<li>面向流(Stream Oriented)：相当于水管，一个steam一个方向出水的水管</li>
<li>阻塞IO(Blocking IO)</li>
<li>无选择器</li>
</ul>
</li>
<li>NIO<ul>
<li>面向缓冲区(Buffer Oriented)：相当于铁路，一条铁路上面有一个缓冲区可以装数据然后双向运输</li>
<li>非阻塞IO(Non Blocking IO)</li>
<li>选择器(Selectors)</li>
</ul>
</li>
</ul>
<p>NIO系统的核心：通道表示打开到IO设备的连接。若需要使用NIO系统，需要获取用于连接IO设备的通道以及用于容纳数据的缓冲区，然后操作缓冲区，对数据进行处理。</p>
<h3 id="缓冲区-Buffer"><a href="#缓冲区-Buffer" class="headerlink" title="缓冲区(Buffer)"></a>缓冲区(Buffer)</h3><ol>
<li>缓冲区(Buffer):在NIO中复制数据的春秋，缓冲区就是数组。</li>
</ol>
<ul>
<li>根据数据类型的不同可以分配对应的缓冲区，boolean类型除外</li>
</ul>
<ol start="2">
<li>缓冲区存取数据的两个核心方法：</li>
</ol>
<ul>
<li>put()</li>
<li>get()</li>
</ul>
<ol start="3">
<li>缓冲区四个核心属性<ol>
<li>int capacity(容量): 表示缓冲区中最大存储数据的容量。一旦声明不能改变。</li>
<li>limit: 界限，表示缓冲区中可以操作数据的大小，即limit后的数据不能进行读写</li>
<li>position: 位置，表示缓冲区中正在操作数据的位置，且需满足(position &lt;&#x3D; limit &lt;&#x3D; capacity)</li>
<li>mark: 标记，标记当前position的位置，可以通过<code>reset()</code>恢复到mark的位置</li>
</ol>
</li>
</ol>
<p>这几个属性位于<code>java.nio.Buffer</code>类里</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Buffer</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * The characteristics of Spliterators that traverse and split elements</span><br><span class="hljs-comment">     * maintained in Buffers.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SPLITERATOR_CHARACTERISTICS</span> <span class="hljs-operator">=</span><br>        Spliterator.SIZED | Spliterator.SUBSIZED | Spliterator.ORDERED;<br><br>    <span class="hljs-comment">// Invariants: mark &lt;= position &lt;= limit &lt;= capacity</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">mark</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">position</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> limit;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> capacity;<br></code></pre></td></tr></table></figure>

<h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abcde&quot;</span>;<br>    <span class="hljs-comment">// 分配一个指定大小的缓冲区</span><br>    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>    System.out.println(buf.position()); <span class="hljs-comment">// 0</span><br>    System.out.println(buf.limit()); <span class="hljs-comment">// 1024</span><br>    System.out.println(buf.capacity()); <span class="hljs-comment">// 1024</span><br>    <span class="hljs-comment">// 写数据</span><br>    buf.put(str.getBytes());<br>    System.out.println(buf.position()); <span class="hljs-comment">// 5</span><br>    System.out.println(buf.limit()); <span class="hljs-comment">// 1024</span><br>    System.out.println(buf.capacity()); <span class="hljs-comment">// 1024</span><br>    <span class="hljs-comment">// 切换读取数据模式</span><br>    buf.flip();<br>    System.out.println(buf.position()); <span class="hljs-comment">// 0</span><br>    System.out.println(buf.limit()); <span class="hljs-comment">// 5</span><br>    System.out.println(buf.capacity()); <span class="hljs-comment">// 1024</span><br>    <span class="hljs-comment">// 读数据</span><br>    <span class="hljs-type">byte</span>[] dst = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[buf.limit()];<br>    buf.get(dst);<br>    System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(dst, <span class="hljs-number">0</span>, dst.length)); <span class="hljs-comment">// abcd</span><br>    System.out.println(buf.position()); <span class="hljs-comment">// 5</span><br>    System.out.println(buf.limit()); <span class="hljs-comment">// 5</span><br>    System.out.println(buf.capacity()); <span class="hljs-comment">// 1024</span><br>    <span class="hljs-comment">// rewind() 可重复读数据</span><br>    buf.rewind();<br>    System.out.println(buf.position()); <span class="hljs-comment">// 0</span><br>    System.out.println(buf.limit()); <span class="hljs-comment">// 5</span><br>    System.out.println(buf.capacity()); <span class="hljs-comment">// 1024</span><br>    <span class="hljs-comment">// clear() 清空缓冲区，但是数据依然存在且处于被遗忘状态</span><br>    buf.clear();<br>    System.out.println(buf.position()); <span class="hljs-comment">// 0</span><br>    System.out.println(buf.limit()); <span class="hljs-comment">// 1024</span><br>    System.out.println(buf.capacity()); <span class="hljs-comment">// 1024</span><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abcde&quot;</span>;<br>    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>    buf.put(str.getBytes());<br>    buf.flip();<br>    <span class="hljs-type">byte</span>[] dst = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[buf.limit()];<br>    buf.get(dst, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>);<br>    System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(dst, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>));<br>    System.out.println(buf.position()); <span class="hljs-comment">// 2</span><br>    buf.mark();<br>    buf.get(dst, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br>    System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(dst, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>));<br>    System.out.println(buf.position()); <span class="hljs-comment">// 4</span><br>    buf.reset();<br>    System.out.println(buf.position()); <span class="hljs-comment">// 2</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>直接缓冲区与非直接缓冲区</li>
</ol>
<ul>
<li>非直接缓冲区：通过<code>allocate()</code>方法分配的缓冲区，缓冲区建立在JVM的内存中</li>
<li>直接缓冲区：通过<code>allocateDirect()</code>方法分配的直接缓冲区或者使用FileChannel的map()方法返回MappedByteBuffer对象，将缓冲区建立在物理内存中。可以提高效率</li>
</ul>
<h3 id="通道-Channel"><a href="#通道-Channel" class="headerlink" title="通道(Channel)"></a>通道(Channel)</h3><p>用于源节点和目标节点间的连接，在NIO中复制缓冲区中数据的传输。Channel本身不存储数据，需要配合缓冲区使用。</p>
<h4 id="通道主要实现类"><a href="#通道主要实现类" class="headerlink" title="通道主要实现类"></a>通道主要实现类</h4><ul>
<li>java.nio.channels.CHannel<ul>
<li>FileChannel</li>
<li>SocketChannel</li>
<li>ServerSocketChannel</li>
<li>DatagramChannel</li>
</ul>
</li>
</ul>
<h4 id="获取通道的几种方式"><a href="#获取通道的几种方式" class="headerlink" title="获取通道的几种方式"></a>获取通道的几种方式</h4><ol>
<li>Java针对支持通道的类提供了<code>getChannel()</code>方法用于获取对应的通道</li>
</ol>
<ul>
<li>本地IO<ul>
<li>FileInputStream</li>
<li>FileOutputStream</li>
<li>RandomAccessFile</li>
</ul>
</li>
<li>网络IO<ul>
<li>Socket</li>
<li>ServerSocket</li>
<li>DatagramSocket</li>
</ul>
</li>
</ul>
<ol start="2">
<li>JDK1.7提供的NIO.2针对各个通道提供了静态方法<code>open()</code></li>
<li>JDK1.7中的NIO.2的Files工具类的<code>newByteChannel()</code>方法</li>
</ol>
<h4 id="通道使用案例"><a href="#通道使用案例" class="headerlink" title="通道使用案例"></a>通道使用案例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 直接缓冲区：利用通道实现本地文件复制(内存映射文件)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">FileChannel</span> <span class="hljs-variable">inChannel</span> <span class="hljs-operator">=</span> FileChannel.open(Paths.get(<span class="hljs-string">&quot;1.png&quot;</span>), StandardOpenOption.READ);<br>    <span class="hljs-type">FileChannel</span> <span class="hljs-variable">outChannel</span> <span class="hljs-operator">=</span> FileChannel.open(Paths.get(<span class="hljs-string">&quot;3.png&quot;</span>), StandardOpenOption.WRITE, StandardOpenOption.READ, StandardOpenOption.CREATE_NEW);<br>    <span class="hljs-comment">// 内存映射文件</span><br>    <span class="hljs-type">MappedByteBuffer</span> <span class="hljs-variable">inMappedBuffer</span> <span class="hljs-operator">=</span> inChannel.map(FileChannel.MapMode.READ_ONLY, <span class="hljs-number">0</span>, inChannel.size());<br>    <span class="hljs-type">MappedByteBuffer</span> <span class="hljs-variable">outMappedBuffer</span> <span class="hljs-operator">=</span> outChannel.map(FileChannel.MapMode.READ_WRITE, <span class="hljs-number">0</span>, inChannel.size());<br>    <span class="hljs-comment">// 直接对缓冲区进行数据的读写操作</span><br>    <span class="hljs-type">byte</span>[] dst = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[inMappedBuffer.limit()];<br>    inMappedBuffer.get(dst);<br>    outMappedBuffer.put(dst);<br><br>    inChannel.close();<br>    outChannel.close();<br>&#125;<br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">FileChannel</span> <span class="hljs-variable">inChannel</span> <span class="hljs-operator">=</span> FileChannel.open(Paths.get(<span class="hljs-string">&quot;1.png&quot;</span>), StandardOpenOption.READ);<br>    <span class="hljs-type">FileChannel</span> <span class="hljs-variable">outChannel</span> <span class="hljs-operator">=</span> FileChannel.open(Paths.get(<span class="hljs-string">&quot;3.png&quot;</span>), StandardOpenOption.WRITE, StandardOpenOption.READ, StandardOpenOption.CREATE_NEW);<br><br>    inChannel.transferTo(<span class="hljs-number">0</span>, inChannel.size(), outChannel);<br><br>    inChannel.close();<br>    outChannel.close();<br>&#125;<br><br></code></pre></td></tr></table></figure>


<h4 id="分散-Scatter-于聚集-Gather"><a href="#分散-Scatter-于聚集-Gather" class="headerlink" title="分散(Scatter)于聚集(Gather)"></a>分散(Scatter)于聚集(Gather)</h4><ul>
<li>分散读取(Scattering Reads): 将通道中的数据分散到多个缓冲区中</li>
<li>聚集写入(Gathering Writes): 将多个缓冲区中的数据聚集到通道中</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test4</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">RandomAccessFile</span> <span class="hljs-variable">raf1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RandomAccessFile</span>(<span class="hljs-string">&quot;1.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-comment">// 获取通道</span><br>    <span class="hljs-type">FileChannel</span> <span class="hljs-variable">fileChannel1</span> <span class="hljs-operator">=</span> raf1.getChannel();<br>    <span class="hljs-comment">// 分配多个缓冲区</span><br>    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf1</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">100</span>);<br>    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf2</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>    <span class="hljs-comment">// 分散读取</span><br>    ByteBuffer[] bufs = &#123;buf1, buf2&#125;;<br>    fileChannel1.read(bufs);<br><br>    <span class="hljs-keyword">for</span> (ByteBuffer byteBuffer : bufs) &#123;<br>        byteBuffer.flip();<br>    &#125;<br>    System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(bufs[<span class="hljs-number">0</span>].array(), <span class="hljs-number">0</span>, bufs[<span class="hljs-number">0</span>].limit()));<br><br>    <span class="hljs-comment">// 聚集写入</span><br>    <span class="hljs-type">RandomAccessFile</span> <span class="hljs-variable">raf2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RandomAccessFile</span>(<span class="hljs-string">&quot;2.txt&quot;</span>, <span class="hljs-string">&quot;rw&quot;</span>);<br>    <span class="hljs-type">FileChannel</span> <span class="hljs-variable">fileChannel2</span> <span class="hljs-operator">=</span> raf2.getChannel();<br>    fileChannel2.write(bufs);<br><br>    fileChannel1.close();<br>    fileChannel2.close();<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="字符集-Charset"><a href="#字符集-Charset" class="headerlink" title="字符集(Charset)"></a>字符集(Charset)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test6</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CharacterCodingException &#123;<br>    <span class="hljs-type">Charset</span> <span class="hljs-variable">cs1</span> <span class="hljs-operator">=</span> Charset.forName(<span class="hljs-string">&quot;GBK&quot;</span>);<br>    <span class="hljs-comment">// 获取编码器与解码器</span><br>    <span class="hljs-type">CharsetEncoder</span> <span class="hljs-variable">ce</span> <span class="hljs-operator">=</span> cs1.newEncoder();<br>    <span class="hljs-type">CharsetDecoder</span> <span class="hljs-variable">cd</span> <span class="hljs-operator">=</span> cs1.newDecoder();<br><br>    <span class="hljs-type">CharBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> CharBuffer.allocate(<span class="hljs-number">1024</span>);<br>    buffer.put(<span class="hljs-string">&quot;获取编码器与&quot;</span>);<br>    buffer.flip();<br><br>    <span class="hljs-comment">// 编码</span><br>    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">bBuf</span> <span class="hljs-operator">=</span> ce.encode(buffer);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) &#123;<br>        System.out.println(bBuf.get());<br>    &#125;<br><br>    <span class="hljs-comment">// 解码</span><br>    bBuf.flip();<br>    <span class="hljs-type">CharBuffer</span> <span class="hljs-variable">cBuf</span> <span class="hljs-operator">=</span> cd.decode(bBuf);<br>    System.out.println(cBuf.toString());<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="阻塞式网络通信"><a href="#阻塞式网络通信" class="headerlink" title="阻塞式网络通信"></a>阻塞式网络通信</h3><p>使用NIO完成网络通信需要：</p>
<ol>
<li>通道(Channel): 负责连接<ul>
<li>java.nio.channels.Channel接口<ul>
<li>SelectableChannel<ul>
<li>SocketChannel</li>
<li>ServerSocketChannel</li>
<li>DatagramChannel</li>
<li>Pipe.SinkChannel</li>
<li>Pipe.SourceChannel</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>缓冲区(Buffer): 负责数据的存取</li>
<li>选择器(Selector): 是SelectableChannel的多路复用器。用于监控SelectableChannel的IO状况</li>
</ol>
<h3 id="非阻塞式网络通信"><a href="#非阻塞式网络通信" class="headerlink" title="非阻塞式网络通信"></a>非阻塞式网络通信</h3><h4 id="使用ServerSocketChannel"><a href="#使用ServerSocketChannel" class="headerlink" title="使用ServerSocketChannel"></a>使用ServerSocketChannel</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.sicmatr1x.nio;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.net.InetSocketAddress;<br><span class="hljs-keyword">import</span> java.nio.ByteBuffer;<br><span class="hljs-keyword">import</span> java.nio.channels.SelectionKey;<br><span class="hljs-keyword">import</span> java.nio.channels.Selector;<br><span class="hljs-keyword">import</span> java.nio.channels.ServerSocketChannel;<br><span class="hljs-keyword">import</span> java.nio.channels.SocketChannel;<br><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><span class="hljs-keyword">import</span> java.util.Iterator;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestNonBlockingNIO</span> &#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">client</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">sChannel</span> <span class="hljs-operator">=</span> SocketChannel.open(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">9898</span>));<br>        <span class="hljs-comment">// 切换成非阻塞模式</span><br>        sChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>        <span class="hljs-comment">// 分配缓冲区</span><br>        <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>        <span class="hljs-comment">// 发送数据</span><br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        <span class="hljs-keyword">while</span>(scanner.hasNext())&#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> scanner.next();<br>            buf.put((LocalDateTime.now().toString() + <span class="hljs-string">&quot;:&quot;</span> + str).getBytes());<br>            buf.flip();<br>            sChannel.write(buf);<br>            buf.clear();<br>        &#125;<br><br>        sChannel.close();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">server</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ServerSocketChannel</span> <span class="hljs-variable">ssChannel</span> <span class="hljs-operator">=</span> ServerSocketChannel.open();<br>        <span class="hljs-comment">// 切换成非阻塞模式</span><br>        ssChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>        <span class="hljs-comment">// 绑定连接</span><br>        ssChannel.bind(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-number">9898</span>));<br>        <span class="hljs-comment">// 获取选择器</span><br>        <span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();<br>        <span class="hljs-comment">// 将通道注册到选择器，并且指定监听事件</span><br>        ssChannel.register(selector, SelectionKey.OP_ACCEPT);<br>        <span class="hljs-comment">// 轮询式的获取选择器上已经准备就绪的事件</span><br>        <span class="hljs-keyword">while</span> (selector.select() &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// 获取当前选择器中所有注册的且已就绪的选择键</span><br>            Iterator&lt;SelectionKey&gt; iterator = selector.selectedKeys().iterator();<br>            <span class="hljs-comment">// 迭代</span><br>            <span class="hljs-keyword">while</span>(iterator.hasNext()) &#123;<br>                <span class="hljs-comment">// 获取准备就绪的事件</span><br>                <span class="hljs-type">SelectionKey</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> iterator.next();<br>                <span class="hljs-comment">// 判断是什么事件就绪</span><br>                <span class="hljs-keyword">if</span> (key.isAcceptable()) &#123; <span class="hljs-comment">// 若为接收就绪</span><br>                    <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">sChannel</span> <span class="hljs-operator">=</span> ssChannel.accept();<br>                    sChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>                    sChannel.register(selector, SelectionKey.OP_READ);<br><br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.isReadable()) &#123;<br>                    <span class="hljs-comment">// 获取当前选择器上读就绪的通道</span><br>                    <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">sChannel</span> <span class="hljs-operator">=</span> (SocketChannel)key.channel();<br><br>                    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br><br>                    <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">while</span>((len = sChannel.read(buffer)) &gt; <span class="hljs-number">0</span>) &#123;<br>                        buffer.flip();<br>                        System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(buffer.array(), <span class="hljs-number">0</span>, len));<br>                        buffer.clear();<br>                    &#125;<br>                &#125;<br>                <span class="hljs-comment">// 取消选择键</span><br>                iterator.remove();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h4 id="使用DatagramChannel"><a href="#使用DatagramChannel" class="headerlink" title="使用DatagramChannel"></a>使用DatagramChannel</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.sicmatr1x.nio;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.net.InetSocketAddress;<br><span class="hljs-keyword">import</span> java.nio.ByteBuffer;<br><span class="hljs-keyword">import</span> java.nio.channels.DatagramChannel;<br><span class="hljs-keyword">import</span> java.nio.channels.SelectionKey;<br><span class="hljs-keyword">import</span> java.nio.channels.Selector;<br><span class="hljs-keyword">import</span> java.util.Date;<br><span class="hljs-keyword">import</span> java.util.Iterator;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestNonBlockingNIO2</span> &#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">DatagramChannel</span> <span class="hljs-variable">dc</span> <span class="hljs-operator">=</span> DatagramChannel.open();<br><br>        dc.configureBlocking(<span class="hljs-literal">false</span>);<br><br>        <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br><br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br><br>        <span class="hljs-keyword">while</span>(scan.hasNext()) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> scan.next();<br>            buffer.put((<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().toString() + <span class="hljs-string">&quot;:&quot;</span> + str).getBytes());<br>            dc.send(buffer, <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">9898</span>));<br>            buffer.clear();<br>        &#125;<br>        dc.close();<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">DatagramChannel</span> <span class="hljs-variable">dc</span> <span class="hljs-operator">=</span> DatagramChannel.open();<br><br>        dc.configureBlocking(<span class="hljs-literal">false</span>);<br><br>        dc.bind(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-number">9898</span>));<br><br>        <span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();<br><br>        dc.register(selector, SelectionKey.OP_READ);<br><br>        <span class="hljs-keyword">while</span>(selector.select() &gt; <span class="hljs-number">0</span>) &#123;<br>            Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();<br>            <span class="hljs-keyword">while</span>(it.hasNext()) &#123;<br>                <span class="hljs-type">SelectionKey</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> it.next();<br>                <span class="hljs-keyword">if</span>(key.isReadable()) &#123;<br>                    <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>                    dc.receive(buffer);<br>                    buffer.flip();<br>                    System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(buffer.array(), <span class="hljs-number">0</span>, buffer.limit()));<br>                &#125;<br>            &#125;<br>            it.remove();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.sicmatr1x.nio;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.nio.ByteBuffer;<br><span class="hljs-keyword">import</span> java.nio.channels.Pipe;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestPip</span> &#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// 获取管道</span><br>        <span class="hljs-type">Pipe</span> <span class="hljs-variable">pipe</span> <span class="hljs-operator">=</span> Pipe.open();<br>        <span class="hljs-comment">// 将缓冲区中的数据写入管道</span><br>        <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>        Pipe.<span class="hljs-type">SinkChannel</span> <span class="hljs-variable">sinkChannel</span> <span class="hljs-operator">=</span> pipe.sink();<br>        buffer.put(<span class="hljs-string">&quot;通过管道发送数据&quot;</span>.getBytes());<br>        buffer.flip();<br>        sinkChannel.write(buffer);<br><br>        <span class="hljs-comment">// 读取数据</span><br>        <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer1</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br>        Pipe.<span class="hljs-type">SourceChannel</span> <span class="hljs-variable">sourceChannel</span> <span class="hljs-operator">=</span> pipe.source();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> sourceChannel.read(buffer1);<br>        System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(buffer1.array(), <span class="hljs-number">0</span>, len));<br><br>        sourceChannel.close();<br>        sinkChannel.close();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2022/08/13/BigData/HDFS/">← Next HDFS</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2022/07/16/JVM/JVM-11_%E7%9B%B4%E6%8E%A5%E5%86%85%E5%AD%98/">JVM-11_直接内存 Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="文章目录">≡</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Sicmatr1x</a></h1><div id="description"><p>INTP/Traveller/Stoicism/Crypto-anarchism/Minimalism/Cosmopolitanism/English learner/Crypto/Java Engineer</p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-NIO"><span class="toc-number">1.</span> <span class="toc-text">Java NIO</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB"><span class="toc-number">1.0.1.</span> <span class="toc-text">区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA-Buffer"><span class="toc-number">1.1.</span> <span class="toc-text">缓冲区(Buffer)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">实例代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E9%81%93-Channel"><span class="toc-number">1.3.</span> <span class="toc-text">通道(Channel)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E9%81%93%E4%B8%BB%E8%A6%81%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">1.3.1.</span> <span class="toc-text">通道主要实现类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%80%9A%E9%81%93%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">1.3.2.</span> <span class="toc-text">获取通道的几种方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E9%81%93%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">通道使用案例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E6%95%A3-Scatter-%E4%BA%8E%E8%81%9A%E9%9B%86-Gather"><span class="toc-number">1.3.4.</span> <span class="toc-text">分散(Scatter)于聚集(Gather)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86-Charset"><span class="toc-number">1.3.5.</span> <span class="toc-text">字符集(Charset)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BB%E5%A1%9E%E5%BC%8F%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1"><span class="toc-number">1.4.</span> <span class="toc-text">阻塞式网络通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%BC%8F%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1"><span class="toc-number">1.5.</span> <span class="toc-text">非阻塞式网络通信</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ServerSocketChannel"><span class="toc-number">1.5.1.</span> <span class="toc-text">使用ServerSocketChannel</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8DatagramChannel"><span class="toc-number">1.5.2.</span> <span class="toc-text">使用DatagramChannel</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E9%81%93"><span class="toc-number">1.6.</span> <span class="toc-text">管道</span></a></li></ol></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{gitalk = new Gitalk({
 clientID: '',
 clientSecret: '',
 repo: 'blog-comments',
 owner: 'Sicmatr1x',
 admin: ['Sicmatr1x'],
 distractionFreeMode: false,
 id: 
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();}</script><script src="/js/arknights.js"></script><script src="/js/pjax.js"></script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>