<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>比特币是什么 | Sicmatr1x's Blog</title><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Sicmatr1x's Blog" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/toolkit/"><span class="navItemTitle">Toolkit</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>比特币是什么</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2019-10-30T11:42:53.000Z" id="date"> 2019-10-30</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2022-02-25T16:00:00.000Z" id="updated"> 2022-02-26</time></div></span></div></div><hr><div id="post-content"><h2 id="使用简单的js代码来讲述比特币的工作原理"><a href="#使用简单的js代码来讲述比特币的工作原理" class="headerlink" title="使用简单的js代码来讲述比特币的工作原理"></a>使用简单的js代码来讲述比特币的工作原理</h2><h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><ul>
<li>在一个含有N(N&gt;2)个人的小团体里建立一个通用的系统</li>
<li>该货币系统使用的货币没有实体媒介，即为数据形式存在</li>
<li>该转账操作需要通过互联网(或是团体里的局域网)来进行</li>
</ul>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>假设存在一个有10个人的小团体，每个人都有自己的私有存储空间</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> peopleList = []<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    peopleList.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">name</span>: i,<br>        <span class="hljs-attr">note</span>: [],<br>        <span class="hljs-attr">historyList</span>: []<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>首先要假设每个人账户里面都有至少1000块来自系统(<code>-1</code>)，否则无法进行转账</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++) &#123;<br>        peopleList[i].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>            <span class="hljs-attr">from</span>: -<span class="hljs-number">1</span>,<br>            <span class="hljs-attr">to</span>: j,<br>            <span class="hljs-attr">money</span>: <span class="hljs-number">1000</span><br>        &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>第3个人转100给第9个人：记做 3-&gt;9: 100，全部人记录下来这个事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    peopleList[i].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">from</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-attr">to</span>: <span class="hljs-number">9</span>,<br>        <span class="hljs-attr">money</span>: <span class="hljs-number">100</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这样，一笔转账就被认为是完成了。</p>
<p>但是当转账的记录太多的时候每个人的存储空间就会出现不够用的情况，这个时候就要进行压缩操作。那么问题来了，压缩密钥怎么办，若是保存在一个人的手上肯定不行，所以就需要使用该网络中每个人都同意的唯一一把钥匙来密封它。通过密封，我们可以保证，一旦历史记录的备份已经被存入每一个人的文件夹，没有人能够对它作出任何更改。因此一旦压缩完成，那么这个压缩包就是绝对可信的。</p>
<p>这个压缩包的hash值被人们称为“矿”，同时也是工作证明。</p>
<p>一旦每个人都用尽自己的空间、无法记录进一步的交易，他们就开始卖力地计算历史交易记录的hash，使得它可以被藏入历史hash值列表<code>historyList</code>中。在网络中，每个人都进行这个计算，而最早算出hash值的那个人会向其他所有人宣布这个值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> maxHistory = <span class="hljs-number">10</span><br><span class="hljs-keyword">let</span> sealingNumber<br><span class="hljs-keyword">if</span> (peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>.<span class="hljs-property">length</span> &gt;= maxHistory) &#123;<br>    sealingNumber = <span class="hljs-title function_">hash</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>))<br>    peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span> = []<br>&#125;<br></code></pre></td></tr></table></figure>

<p>听到hash值之后，每个人都立即验证<code>check()</code>它是否能产生要求的输出值。如果是的，每个人都为他们的历史hash值列表<code>historyList</code>存入该值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">check</span>(sealingNumber) === <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(peopleList[i].<span class="hljs-property">note</span>)) &#123;<br>        peopleList[i].<span class="hljs-property">historyList</span>.<span class="hljs-title function_">push</span>(sealingNumber)<br>        peopleList[i].<span class="hljs-property">note</span> = []<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果对某人，比如7来说，那个<code>sealingNumber</code>无法产生要求的输出值，怎么办？</p>
<p>可能的原因有：</p>
<ul>
<li>他获取到的<code>sealingNumber</code>与之前在网络中宣布的不同</li>
<li>他可能记录错了<code>note</code>数组</li>
</ul>
<p>他只能放弃自己错误的<code>sealingNumber</code>然后从网络里获取别人的<code> note</code>数组和<code>historyList</code>数组，否则他将被禁止进入网络</p>
<p>前面提到了hash值即<code>sealingNumber</code>也可以被称作矿，这是因为第一个计算出hash值的人将得到免费的金钱作为对他的努力（比如：付出的CPU算力和电力）的奖励。</p>
<p>下面假设奖励为1</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> maxHistory = <span class="hljs-number">10</span><br><span class="hljs-keyword">let</span> sealingNumber<br><span class="hljs-keyword">if</span> (peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>.<span class="hljs-property">length</span> &gt;= maxHistory) &#123;<br>    sealingNumber = <span class="hljs-title function_">hash</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>))<br>    peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span> = []<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFirst</span>(sealingNumber)) &#123;<br>        peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>            <span class="hljs-attr">from</span>: -<span class="hljs-number">1</span>,<br>            <span class="hljs-attr">to</span>: <span class="hljs-number">7</span>,<br>            <span class="hljs-attr">money</span>: <span class="hljs-number">1</span><br>        &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    peopleList[i].<span class="hljs-property">note</span> = []<br>    peopleList[i].<span class="hljs-property">historyList</span>.<span class="hljs-title function_">push</span>(sealingNumber)<br>    peopleList[i].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">from</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-attr">to</span>: <span class="hljs-number">7</span>,<br>        <span class="hljs-attr">money</span>: <span class="hljs-number">1</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这就是比特币变为现实的方式。它是在区块链上被用来交易的第一种货币。同时，人们被奖励以比特币作为回报，以使在网络上，计算hash值努力会继续进行。</p>
<p>但是这里有个问题如果有人将很久之前的<code> note</code>数组和<code>historyList</code>数组中对应的一项同时进行修改在检查上面将会成本较高，但是我们可以将每一个<code> note</code>数组的最后一项改为上一个<code>historyList</code>数组的值也就是上一个<code> note</code>数组的hash值。这样，每一个hash值都依赖于它之前的<code> note</code>数组。因此，如果有人要修改一个<code> note</code>数组的历史记录，他将同样必须改变该页以后所有<code> note</code>数组的内容和hash值，以使这条链保持一致。</p>
<p>如果有人想要这么做的话那么他将会从改变的那个<code> note</code>数组开始计算hash值，但是计算也是需要消耗算力的，他的链增长速度肯定赶不上整个社区的链的增长速度，除非他拥有超越整个社区的算力，当然这都是后话了。有句话叫：在绝对的力量面前任何技巧都是花拳绣腿。</p>
<p>所以这保证了在一个网络中，最长的链就是可信的链。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> maxHistory = <span class="hljs-number">10</span><br><span class="hljs-keyword">let</span> sealingNumber<br><span class="hljs-keyword">if</span> (peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>.<span class="hljs-property">length</span> &gt; maxHistory) &#123;<br>    peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">from</span>: <span class="hljs-literal">null</span>,<br>        <span class="hljs-attr">to</span>: <span class="hljs-literal">null</span>,<br>        <span class="hljs-attr">money</span>: peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">historyList</span>[historyList.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]<br>    &#125;)<br>    sealingNumber = <span class="hljs-title function_">hash</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>))<br>    peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span> = []<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFirst</span>(sealingNumber)) &#123;<br>        peopleList[<span class="hljs-number">7</span>].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>            <span class="hljs-attr">from</span>: -<span class="hljs-number">1</span>,<br>            <span class="hljs-attr">to</span>: <span class="hljs-number">7</span>,<br>            <span class="hljs-attr">money</span>: <span class="hljs-number">1</span><br>        &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    peopleList[i].<span class="hljs-property">note</span> = []<br>    peopleList[i].<span class="hljs-property">historyList</span>.<span class="hljs-title function_">push</span>(sealingNumber)<br>    peopleList[i].<span class="hljs-property">note</span>.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">from</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-attr">to</span>: <span class="hljs-number">7</span>,<br>        <span class="hljs-attr">money</span>: <span class="hljs-number">1</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>万一，是6个人呢？</p>
<p>在这种情况下，这个协议将会变成一纸空文。使得整个社区变成这6个人的后花园。它就是人们所知的“51%攻击”。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2019/12/06/Database/Redis/Redis/">← Next Redis</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2019/10/28/Nodejs/Node.js%20Unit%20Test%20Framework/">Node.js Unit Test Framework Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="文章目录">≡</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Sicmatr1x</a></h1><div id="description"><p>INTP/Traveller/Stoicism/Crypto-anarchism/Minimalism/Cosmopolitanism/English learner/Crypto/Java Engineer</p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%80%E5%8D%95%E7%9A%84js%E4%BB%A3%E7%A0%81%E6%9D%A5%E8%AE%B2%E8%BF%B0%E6%AF%94%E7%89%B9%E5%B8%81%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">使用简单的js代码来讲述比特币的工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number">1.1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.2.</span> <span class="toc-text">步骤</span></a></li></ol></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{gitalk = new Gitalk({
 clientID: '',
 clientSecret: '',
 repo: 'blog-comments',
 owner: 'Sicmatr1x',
 admin: ['Sicmatr1x'],
 distractionFreeMode: false,
 id: 
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();}</script><script src="/js/arknights.js"></script><script src="/js/pjax.js"></script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>